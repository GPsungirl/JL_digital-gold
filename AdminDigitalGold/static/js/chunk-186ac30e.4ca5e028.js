(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-186ac30e"],{"06c5":function(e,t,i){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function s(e,t){if(e){if("string"===typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}i.d(t,"a",(function(){return s}))},"7f6d":function(e,t,i){"use strict";function a(e){for(var t=JSON.parse(JSON.stringify(e)),i=0;i<t.length;i++)t[i]["label"]=t[i].menu_name;return t.filter((function(e){var i=t.filter((function(t){return e["id"]==t["pid"]}));return i.length>0&&(e["children"]=i),0==e["pid"]}))}t["a"]={designData_tree:a}},b501:function(e,t,i){},b85c:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var a=i("06c5");function s(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=Object(a["a"])(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,d=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){d=!0,n=e},f:function(){try{o||null==i["return"]||i["return"]()}finally{if(d)throw n}}}}},f3e4:function(e,t,i){"use strict";var a=i("b501"),s=i.n(a);s.a},feb4:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"userPermission"},[i("div",{staticClass:"query_field mar_b10"},[i("el-row",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handle_addUserPermisson}},[e._v("新增角色")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.refreshData}},[e._v("刷新")])],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[i("el-table-column",{attrs:{prop:"role_name",label:"角色名称",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"role_chinese_name",label:"角色描述",width:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"",label:"操作",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.modi_permisson(t.row)}}},[e._v("调整权限")])]}}])})],1),e._v(" "),i("div",{staticClass:"block mar_t10"},[i("el-pagination",{attrs:{"current-page":e.currentPage,background:"",layout:"total, prev, pager, next, jumper",total:e.pageTotal},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.modi_loading,expression:"modi_loading"}],staticClass:"modiUsers_dialog dialog_tip",attrs:{title:e.d_modi_userPermission.modi_title,visible:e.permission_dialogVisible,width:"40%",center:"","close-on-click-modal":!1,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"update:visible":function(t){e.permission_dialogVisible=t}}},[i("div",[i("el-row",[i("el-col",{attrs:{span:14}},[i("div",{staticClass:"grid-content bg-purple-dark pad_t2"},[i("el-form",{ref:"valid_modiForm",staticClass:"demo-ruleForm valid_form",attrs:{model:e.valid_modiForm,rules:e.modi_rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{model:{value:e.valid_modiForm.name,callback:function(t){e.$set(e.valid_modiForm,"name",t)},expression:"valid_modiForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色描述",prop:"role_chinese_name"}},[i("el-input",{model:{value:e.valid_modiForm.role_chinese_name,callback:function(t){e.$set(e.valid_modiForm,"role_chinese_name",t)},expression:"valid_modiForm.role_chinese_name"}})],1)],1)],1)]),e._v(" "),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"grid-content bg-purple-dark "},[i("el-tree",{ref:"modiTree",attrs:{data:e.modiDialog_tree,"show-checkbox":"","node-key":"id","default-expanded-keys":e.modi_default_ids,"default-checked-keys":e.modi_default_ids,"highlight-current":"",accordion:""}})],1)])],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.permission_dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.modiData_userPermission}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.add_loading,expression:"add_loading"}],staticClass:"addUsers_dialog dialog_tip",attrs:{title:"新增角色",visible:e.addUsers_dialogVisible,width:"40%",center:"","close-on-click-modal":!1,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"update:visible":function(t){e.addUsers_dialogVisible=t}}},[i("div",{staticClass:"dialogBody_addPermission"},[i("el-row",[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple-dark pad_t2"},[i("el-form",{ref:"valid_addForm",staticClass:"valid_form demo-ruleForm",attrs:{model:e.valid_addForm,rules:e.add_rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.valid_addForm.name,callback:function(t){e.$set(e.valid_addForm,"name",t)},expression:"valid_addForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色描述",prop:"role_chinese_name"}},[i("el-input",{attrs:{placeholder:"角色描述"},model:{value:e.valid_addForm.role_chinese_name,callback:function(t){e.$set(e.valid_addForm,"role_chinese_name",t)},expression:"valid_addForm.role_chinese_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色权限",prop:"permission"}},[i("el-select",{attrs:{multiple:"",placeholder:"选择角色权限"},model:{value:e.valid_addForm.permission,callback:function(t){e.$set(e.valid_addForm,"permission",t)},expression:"valid_addForm.permission"}},e._l(e.valid_addForm.permissions,(function(e,t){return i("el-option",{key:t,attrs:{label:e.txt,value:e.id}})})),1)],1)],1)],1)]),e._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content bg-purple-dark pad_l34"},[i("el-tree",{ref:"add_tree",attrs:{data:e.addDialog_tree,"show-checkbox":"","node-key":"id","highlight-current":"",accordion:""}})],1)])],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){e.addUsers_dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.save_addSysRole}},[e._v("确 定")])],1)])],1)},s=[],r=i("b85c"),n=(i("7f7f"),i("96cf"),i("1da1")),o=i("cf45"),d=i("7f6d"),l={name:"sysRole",data:function(){return{tableData:[],tableLoading:!1,pageTotal:100,currentPage:1,permission_dialogVisible:!1,addUsers_dialogVisible:!1,form:{name:"",role_chinese_name:"",permission:""},formLabelWidth:"120px",addDialog_tree:[],modiDialog_tree:[],modi_default_ids:[],valid_addForm:{name:"",role_chinese_name:"",permission:[],permissions:[{id:"edit",txt:"编辑"},{id:"view",txt:"查看"}]},add_rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],role_chinese_name:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},valid_modiForm:{name:"",role_chinese_name:"",permission:[],permissions:[{id:"edit",role_chinese_name:"编辑"},{id:"view",role_chinese_name:"查看"}]},modi_rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],role_chinese_name:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},d_modi_userPermission:{modi_title:"",role_name:"",id:"",permission:"",role_chinese_name:""},modi_loading:!1,add_loading:!1}},created:function(){this.getList_userPermission(1)},methods:{refreshData:function(){this.getList_userPermission(this.currentPage)},getList_userPermission:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var i,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.tableLoading=!0,i={data:{signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId,pageNum:t,pageSize:10}},e.next=4,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/selectSysRole"),i);case 4:a=e.sent,"0000"==a.data.code&&(console.log(a),s=a.data.data.sysRoleList,this.tableData=s,this.pageTotal=a.data.data.page.pageTotal,this.tableLoading=!1);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handle_addUserPermisson:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.addUsers_dialogVisible=!0,this.resetForm("valid_addForm"),this.$refs.add_tree&&this.$refs.add_tree.setCheckedKeys([]),t={data:{signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId}},this.add_loading=!0,e.next=7,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/addSysRole"),t);case 7:i=e.sent,"0000"==i.data.code&&(a=d["a"].designData_tree(i.data.data.sysMenuList),this.addDialog_tree=a,this.add_loading=!1);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getData_onePermission:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={data:{signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId}},e.next=3,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/addSysRole"),t);case 3:i=e.sent,"0000"==i.data.code&&(a=d["a"].designData_tree(i.data.data.sysMenuList),this.addDialog_tree=a,this.modiDialog_tree=a);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save_addSysRole:function(){var e=this,t=this.$refs.add_tree.getCheckedKeys(),i=this.$refs.add_tree.getHalfCheckedKeys();if(i.length>0&&(t=t.concat(i)),0!=t.length){if(this.m_valid_addForm("valid_addForm")){var a={data:{signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId,mid:t.join(","),permission:this.valid_addForm.permission.join(","),role_chinese_name:this.valid_addForm.role_chinese_name,role_name:this.valid_addForm.name}};this.add_loading=!0,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/saveSysRole"),a).then((function(t){"0000"==t.data.code?(e.add_loading=!1,e.m_message(t.data.msg,"success"),e.getList_userPermission(e.currentPage),e.addUsers_dialogVisible=!1):(e.add_loading=!1,e.m_message(t.data.msg,"success"))})).catch((function(e){console.log(e)}))}}else this.m_message("请为该用户分配权限","warning")},getTreeNode:function(){console.log(this.$refs.add_tree.getCheckedKeys())},modi_permisson:function(e){var t=this;this.permission_dialogVisible=!0,this.d_modi_userPermission.permission=e.permission,this.d_modi_userPermission.role_name=e.role_name,this.d_modi_userPermission.role_chinese_name=e.role_chinese_name,this.d_modi_userPermission.id=e.id,this.modi_default_ids=[],this.d_modi_userPermission.modi_title="调整"+e.role_name+"的权限";var i={data:{id:e.id,signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId}};this.modi_loading=!0,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/updateSysRole"),i).then((function(e){if("0000"==e.data.code){var i=d["a"].designData_tree(e.data.data.menuList);t.modiDialog_tree=i;var a=[];if(e.data.data.sysMenuList.length>0){var s,n=Object(r["a"])(e.data.data.sysMenuList);try{for(n.s();!(s=n.n()).done;){var o=s.value;t.modi_default_ids.push(o.id),a.push(o.id)}}catch(h){n.e(h)}finally{n.f()}}for(var l=0;l<a.length;l++)for(var m=0;m<t.modiDialog_tree.length;m++)if(a[l]==t.modiDialog_tree[m].id&&"children"in t.modiDialog_tree[m]){for(var c=!1,u=0;u<t.modiDialog_tree[m].children.length;u++){var _=a.indexOf(t.modiDialog_tree[m].children[u].id);-1==_&&(c=!0)}c&&a.splice(l,1)}t.modi_default_ids=a,t.$refs.modiTree&&t.$refs.modiTree.setCheckedKeys(t.modi_default_ids);var g=e.data.data.sysRole;t.valid_modiForm.name=g.role_name,t.valid_modiForm.role_chinese_name=g.role_chinese_name,t.modi_loading=!1}})).catch((function(e){}))},modiData_userPermission:function(){var e=this,t=this.$refs.modiTree.getCheckedKeys(),i=this.$refs.modiTree.getHalfCheckedKeys();if(i.length>0&&(t=t.concat(i)),this.m_valid_addForm("valid_modiForm")){var a={data:{signInUserId:this.$store.getters.userId,signInRoleId:this.$store.getters.roleId,id:this.d_modi_userPermission.id,mid:t.join(","),role_chinese_name:this.valid_modiForm.role_chinese_name,role_name:this.valid_modiForm.name}};this.modi_loading=!0,this.$http.post("".concat(o["a"].baseUrl,"/sysRole/saveSysRole"),a).then((function(t){"0000"==t.data.code?(e.modi_loading=!1,e.m_message(t.data.msg,"success"),e.getList_userPermission(e.currentPage),e.permission_dialogVisible=!1):e.m_message(t.data.msg,"success")})).catch((function(e){console.log(e)}))}},handleCurrentChange:function(e){this.currentPage=e,this.getList_userPermission(e)},m_valid_addForm:function(e){var t=!1;return this.$refs[e].validate((function(e){return e?(t=!0,!0):(t=!1,!1)})),t},m_message:function(e,t){this.$message({message:e,type:t})},resetForm:function(e){this.$refs[e]&&this.$refs[e].resetFields()},diguiquchu:function(e,t,i,a,s){var r=this;t.map((function(t,n){t.id==i&&t.child?(s.push(i),r.diguiquchu(e,t.child,i,a,s)):t.id!=i&&t.child&&r.diguiquchu(e,t.child,i,a,s)}))}}},m=l,c=(i("f3e4"),i("2877")),u=Object(c["a"])(m,a,s,!1,null,null,null);t["default"]=u.exports}}]);